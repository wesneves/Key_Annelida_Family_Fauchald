#fUNCIONALIDADES
#
#install.packages("devtools")
#require(devtools)
#install_github("HaoLi111/dichotomousKey")
#dk_classify(key_poly)
#dk_extract(key_poly ,"SYLLIDAE" )

P <- c("Segmentação externa e cerdas ausentes","Segmentação externa e/ou cerdas presentes","Antenas emparelhadas no prostômio","Antenas pareadas ausentes  pelos táteis ao longo do corpo  pequenas formas intersticiais","Corpo longo e esbelto  formas intersticiais","Corpo curto e em forma de saco  pelágico","Corpo um disco achatado com segmentação indistinta  ectoparasitário","O corpo não é um disco achatado  segmentação geralmente distinta  se distinta  então corpo claramente mais longo que largo","Dorso com séries de élitros [escamas] ou cicatrizes elitrais distintas presentes na face dorsal das bases notopodiais em vários segmentos  feltro de notosetas emaranhadas pode estar presente","Dorso sem élitros  cicatrizes elitrais ou feltro","Neuracicula distalmente em forma de martelo","Neuracicula apontada distalmente","Prostômio com uma única antena mediana  dorso com feltro  ou notosetas em forma de arpão ou mantidas eretas sobre o dorso","Prostômio com uma a três antenas  dorso sem feltro  notoseta geralmente distintamente lateral em posição  nunca em forma de arpão","Composto de neurosetas","Neurosetas simples","Todos os segmentos posteriores com élitros  prostômio com uma a três antenas","Élitros alternados com cirros dorsais ao longo de todo o comprimento do corpo  uma antena presente","Glândulas giratórias presentes  antena mediana  se presente  fixada próximo à parte posterior ou média do prostômio  notosetas ausentes","Glândulas giratórias ausentes  antena mediana fixada na margem anterior do prostômio  notosetas geralmente presentes","Notopódios com cerdas expandidas  douradas ou acobreadas que cobrem mais ou menos o dorso","Notoseta de outra forma [pode estar ausente]","Prostômio com grande tubérculo facial e antena mediana  notoseta em rosetas","Prostômio sem tubérculo facial  lateral pareada e uma antena mediana presente  notoseta em fileiras transversais","Extremidade posterior coberta ventralmente por um escudo quitinizado","Extremidade posterior não coberta por um escudo","Prostômio completamente retraído entre os primeiros parapódios que apresentam três pares de cirros tentaculares  parcialmente sustentados por acículos","Prostômio não completamente retraído entre os primeiros parapódios que estão equipados de outra forma")
Q <- c("Extremidade anterior com uma ou várias séries de cerdas longas e especializadas cobrindo a extremidade anterior retrátil ou formando um opérculo ou uma série de espinhos protetores longos [páleas]","Extremidade anterior sem cerdas excepcionalmente longas e especializadas [NOTA  ganchos curtos e fortes podem estar presentes]","Cerdas especializadas longas e com compartimentada  formando uma gaiola protetora ao redor da extremidade anterior retrátil  corpo com numerosas papilas epiteliais","As cerdas anteriores especializadas não formam uma gaiola protetora  extremidade anterior não retrátil  pele-papilas poucas e pequenas  ou ausentes  cerdas de outra forma","Cerdas especializadas delgadas  curvadas distalmente  muitas vezes espinhosas  prostômio com sete antenas","Cerdas especializadas robustas  suaves e não curvadas distalmente  prostômio sem apêndices ou com numerosos tentáculos","Cerdas especializadas em uma fileira transversal  tubo cônico  geralmente formado por grãos de areia bem ajustados","Cerdas anteriores especializadas como um grupo de paleas em forma de leque em ambos os lados da extremidade anterior ou como um opérculo para o tubo","Cerdas especializadas formam paleas  extremidade anterior com dois a quatro pares de brânquias","As cerdas especializadas formam um opérculo  extremidade anterior sem brânquias","Extremidade anterior  incluindo em parte o prostômio  transformada em coroa tentacular","Extremidade anterior não transformada em coroa tentacular [NOTA  Antenas e cirros tentaculares podem estar aglomerados perto da extremidade anterior]","Tubo calcário  membrana torácica presente")
R <- c("Tubo mucóide ou córneo  muitas vezes coberto de grãos de areia  membrana torácica ausente","Tubo irregularmente torcido ou reto  às vezes enrolado próximo à base  corpo simétrico  mais de quatro setigers torácicos","Tubo completamente enrolado  corpo assimétrico  quatro setigers torácicos presentes","Parapódios com uncini em uma ou algumas fileiras distintas  coroa tentacular com radioles lisos ou penados","Pequenos uncini aglomerados em campos densos apenas nos neuropódios  coroa tentacular curta com tentáculos ramificados","Trato digestivo recurvado com ânus muito anteriormente  tórax sem ganchos  exceto no primeiro setígero","Trato digestivo reto com ânus muito posterior ou terminal  tórax com ganchos na maioria dos setigeros","Setigero 4 com um ou alguns espinhos grossos  alguns parapódios medianos fortemente modificados  geralmente em forma de leque  tubos em forma de pergaminho  ou  se corneos  distintamente anulados","Setigero 4 sem espinhos grossos [NOTA  Outros setigeros podem ter cerdas modificadas]  sem parapódios em forma de leque  tubos nunca semelhantes a pergaminhos  se corneos  então sem anéis","Numerosos tentáculos na parte inferior do prostômio ou no peristômio  branquias  se presente  limitado a alguns pares de setigeros anteriores","Extremidade anterior com um número limitado [10 ou menos pares  geralmente] de antenas e cirros tentaculares  ou sem apêndices","Branquias em uma fileira transversal ou oblíqua ou agrupadas em dois grupos de cada lado do dorso anterior  geralmente digiformes[em forma de mão] e suave  mais raramente bipinadas[formato de pena] ou lameladas [NOTA  As brânquias são frequentemente perdidas  mas as cicatrizes permanecem]  tentáculos bucais retráteis  uncini com dentes em uma ou poucas fileiras","Branquias  se presentes  em dois ou três segmentos sucessivos  pedunculadas ou sésseis  ramificadas ou como filamentos numerosos  raramente lisas[suave]  tentáculos bucais não retráteis  uncini com vários dentes em uma ou mais fileiras transversais acima da presa principal [com crista]","Uncinis torácicos de cabo longo  abdominais de cabo curto","Uncini torácico e abdominal de cabo curto  às vezes com um prolongamento posterior no uncini torácico","Prostômio com pelo menos um par de antenas  peristômio geralmente com palpos emparelhados ou cirros tentaculares","Prostômio sem apêndices ou com uma única antena  peristômio com palpos dorsais pareados  no máximo dois pares de cirros tentaculares ou sem apêndices")
S <- c("O prostômio continua posteriormente em uma carúncula  grandes notocerdas furcadas  outros lisos ou serrilhados","Carúncula ausente  notocerdas furcadas  se presentes  pequenas  ou apenas cerdas furcadas presentes","Notosetas dispostas em fileiras transversais no dorso  brânquias mais curtas que as cerdas","Notosetae em tufos nos lobos notopodiais  branquias tufos ramificados conspícuos","Palpos ausentes","Palpos presentes  às vezes como almofadas ventrolaterais no peristômio ou fundidos à extremidade anterior do prostômio  de modo que este último parece fendido  mas geralmente livre e digitado","Setas ausentes  acicula presente apenas nos lobos aciculares prolongados do segundo segmento [primeiro segmento em juvenis]  caso contrário ausente","Cerdas ou acículas ou ambas presentes na maioria dos segmentos","Prostômio longo e cônico  geralmente anelado  com dois pares de antenas na ponta","Prostômio não mais que o dobro da largura  nunca anelado  antenas longas ou curtas","Faringe eversível com quatro mandíbulas em cruz  parapódios todos uni ou birramos","Faringe eversível com mais de quatro mandíbulas  parapodia uniramous anteriormente e biramous posterioriy","Mandíbulas presentes","Mandíbulas ausentes","Cada mandíbula consiste em uma série de dentículos em uma fileira","Cada Jaw consiste em uma única peça","Quatro ou cinco pares de mandíbulas","Um único par de mandíbulas presentes","Tanto cerdas compostas quanto simples presentes  parasitas em crustáceos decápodos","Todas as cerdas compostas  parasitas em peixes","Um par de antenas  formas intersticiais","Mais de um par de antenas","Olhos maiores que o restante do prostômio  com lentes e camadas pigmentadas bem definidas","Olhos  se presentes  menores que o prostômio propriamente dito  geralmente pequenos vasos de pigmento  mas ocorrem olhos com lentes","Série de grandes cápsulas epiteliais no dorso  dois ou três pares de antenas laterais e uma antena mediana não pareada","Cápsulas epiteliais ausentes [NOTA  Cirros dorsais de phyllodocídeos podem estar inflados  mas estão associados aos parapódios e não situados no dorso]","Cirros dorsais grandes e foliosos","Cirros dorsais  se presentes  cirriformes","Setas ausentes  com alguns pares de apêndices anteriormente e posteriormente  parasita em lagostas","Setas presentes  vários pares de apêndices ao longo do corpo","Todas as cerdas compostas  pelágicas","Pelo menos algumas cerdas de formas simples  bentônicas ou parasitárias","Com bandas ciliares no dorso de cada segmento além de um grande órgão ciliar no prostômio  minúsculas formas intersticiais","A ciliação externa limita-se principalmente a pequenas manchas nos órgãos sensoriais e respiratórios  formas pequenas ou grandes","Cinco antenas prostomiais  inquilinos em moluscos bivalves")
T <- c("Quatro antenas  formas bentônicas de vida livre","Cirros interramal entre os noto e neuropódios na maioria das formas  todas as cerdas simples","Cirros interramais ausentes  notocerdaas simples  neurocerdas compostas","Palpos bi ou multiarticulados","Palpos simples  às vezes fundidos ao prostômio  de modo que este último aparece fendido ou formando almofadas ventrolaterais no peristômio","Palpos multiarticulados  cirros tentaculares ausentes","Palpos biarticulados  pelo menos um par de cirros tentaculares","Faringe com mandíbulas emparelhadas  paragnatos ou papilas moles ou ambas na superfície da faringe evertida ou faringe lisa  parapódios geralmente birramados","Faringe geralmente sem mandíbulas  paragnatos ou papilas faríngeas sempre ausentes  faringe evertida muitas vezes com um círculo de papilas distais ou lapelas  parapódios muitas vezes sub-birramous ou unirramous","Palpos almofadas ventrolaterais no peristomium  cinco antenas occipitais e duas frontais","Palpos fundidos anteriormente ao prostômio ou como projeções ventrolaterais livres  máximo cinco antenas","Palpos com projeções ventrolaterais livres  algumas vezes fundidas entre si","Os palpos se fundem ao prostômio de modo que este aparece anteriormente fendido","Prostômio mais longo que largo  com um par de antenas na ponta","Prostômio não maior do que largo [NOTA  os palpos fundidos podem fazer com que pareça mais longo do que é]","Mandíbulas presentes","Mandíbulas ausentes","Parapódios fortemente prolongados  com acicula de sustentação longa  parte anterior do tubo digestivo não visivelmente separada em partes distintas  pelágicas","Parapodios não fortemente prolongado  acícula curta  parte anterior do trato digestivo com um proventrículo visível na maioria das espécies","Faringe eversível  se presente  desarmada","Faringe eversível com quatro pares de maxilares superiores e um par de inferiores")
U <- c("Extremidade anterior  incluindo pró e peristômio sem apêndices [NOTA  Apêndices podem estar presentes em alguns setigeros anteriores]","Prostômio com uma única antena mediana  ou peristômio com pares de palpos ou cirros tentaculares ou ambos pro- e peristômio equipados conforme indicado","Palpos pareados no primeiro ou em um dos primeiros segmentos pós-peristomiais","Palpos pareados ausentes","Ambos  falcígeros compostos e cerdas simples presentes","Todas as cerdas simples  distalmente curvas ou retas  às vezes aciculares","Com um único palpo médio-dorsal em um dos primeiros setigeros [setigeros 3-6 geralmente]","Palpo médio-dorsal ausente","Com séries de filamentos branquiais longos e delgados e cirros tentaculares e dorsais ao longo do corpo [muitas vezes perdidos  as cicatrizes permanecem]","Filamentos branquiais e cirros tentaculares ausentes ou limitados a alguns segmentos","Parapódios fortemente reduzidos de modo que as cerdas aparecem sésseis na parede do corpo  todas as cerdas simples  cerdas capilares verdadeiras ausentes","Parapódios geralmente bem desenvolvidos ou pelo menos presentes como dobras baixas  cerdas geralmente de vários tipos diferentes  incluindo na maioria dos casos cerdas capilares verdadeiras","Tórax com séries de longos cirros dorsais sustentados por acículas","Corpo geralmente não claramente regionalizado  além de papilas e parapódios reduzidos  outros apêndices ausentes","Pelo menos algumas cerdas com estrutura interna de pequenas câmaras","Sem cerdas com câmaras","Com uma papila entre os ramos de cada parapódio  cerdas lisas e ligeiramente recurvadas","Sem papilas entre os ramos  cerdas de outra forma","Cerdas em quatro fascículos em cada segmento [condição birramosa]","Cerdas em dois fascículos em cada segmento [condição unírramosa]","Prostômio uma placa oblíqua  geralmente delimitada por uma flange","Prostômio pontiagudo  arredondado ou brusco","As cerdas incluem espinhos anteriores  uncini rostrados de haste longa e capilares espinhosos ou lisos  segmentos geralmente alongados [vermes-bambu]","As cerdas incluem os tipos bilimbato e espatulado  uncini de cabo longo e cerdas companheiras  segmentos não prolongados","Corpo separado em duas regiões com diferentes tipos de cerdas em uma região torácica e abdominal [NOTA  As regiões às vezes também podem ser definidas em características parapodiais]","Corpo não separado em regiões  distribuição das cerdas e formas parapodiais graduadas ao longo do corpo","Tórax com parapódios laterais  abdômen com noto e neuropódios em posição dorsal","Parapodia lateral em todas as partes do corpo  notopódios frequentemente reduzidos em segmentos posteriores e neuropódios podem formar cinturões quase completos","Cerdas capilares delgadas no tórax e às vezes apenas nos primeiros segmentos abdominais  brânquias  se presentes  filamentos retráteis no abdome","Delgadas cerdas capilares presentes nas partes anterior  mediana e às vezes posterior do corpo  incluindo a região branquial  branquias filamentos não retráteis  espessos ou simples","Extremidade anterior com complexo aparelho maxilar","Aparelho maxilar ausente")
V <- c("Cada mandíbula consiste em uma série de pequenos dentículos","Cada mandíbula composta por uma única peça","Ganchos com capuz presentes em pelo menos alguns setigeros  um par de portadores maxilares","Ganchos com capuz ausentes  três portadores maxilares","Branchiae presente em no máximo 15-20 segmentos  a partir de um dos setigers 4-10","Branquias  se presentes  ou limitadas à extremidade anterior extrema  ou encontradas espalhadas por uma grande parte do corpo","As cerdas incluem espinhos anteriores  uncini rostrados de haste longa e capilares espinhosos ou lisos  segmentos geralmente alongados [vermes-bambu]","Setal distribuição de outra forma  segmentos raramente alongados","As cerdas incluem capilares simples e falcigeros bífidos simples em noto e neuropódios em uma longa região do corpo","Falcigeros bífidos simples ausentes","Prostômio um cone alongado  geralmente mais de duas vezes mais comprido que largo  quase sempre articulado","Prostômio com menos de duas vezes o comprimento  pode ser rombamente cônico  arredondado ou truncado  nunca articulado","Faringe eversível com quatro mandíbulas  parapodios ou todos uniramous ou todos biramous","Faringe eversível com mais de quatro mandíbulas  parapódios anteriores unirramous  os posteriores birramous","Lobos arredondados do parapódio com cirros grandes e facilmente deiscentes  pelágico","Dobras baixas do parapódio ou projeções rombas em forma de botão  cirros  se presente  cirriforme","Falcigeros compostos presentes em setigeros anteriores","Todas as cerdas simples","Neurosetas uncinais em estrutura","Uncini ausente","Todas as cerdas capilares simples  branquias cirriformes  pectíneos ou ausentes  prostômio inteiro  pontiagudo ou arredondado","Cerdas furcadas e aciculares geralmente presentes  branquias  se presente  limitado à extremidade anterior e fortemente arborescente  prostômio em forma de T ou bífido","Prostômio com antena mediana","Prostômio sem apêndices","Branchiae presente em no máximo 15-20 segmentos  começando por um dos setigers 4-10","Distribuição branquial diferente ou branquiais ausentes","Cirros notopodiais em forma de balão em alguns setigres  cerdas plumosas presentes","Cirros notopodiais cirriformes ou foliosos  cerdas plumosas ausentes","Com dois pares de cirros tentaculares  cerdas compostas","Sem cirros tentaculares  cerdas simples")
X <- c("Cerdas apêndices longos e delgados  pelágico","Cerdas apêndices curtos  parasita","Com várias séries de pequenos uncini de eixo longo nos neutrópodes","Uncini em fileiras simples ou ausentes","Prostômio achatado e espatulado  tão largo quanto a parte mais larga do corpo","Prostômio não achatado  distintamente mais estreito do que a parte mais larga do corpo","Parapodia imperceptível  segmentos abdominais prolongados com cerdas formando cinturões completos ao redor do corpo","Parapodia bem desenvolvido  segmentos abdominais geralmente não prolongados  cerdas limitadas a tufos laterais","Todos os parapódios birramados  exceto possivelmente o primeiro","Parapódio mediano uníramo","Uncini ausente  notopódios com acículas  mas sem cerdas  verdadeiras brânquias ausentes","Uncini normalmente presente  pelo menos nos neuropódios  notopódios com cerdas além de acicula  branquias presentes ou ausentes")
dados <- c(P,Q,R,S,T,U,V,X)
id = c(1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39,40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49,50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59,60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90,91,91,92,92,93,93,94,94)
P <- dados
G <- c('2','4','3','DINOPHILIDAE','PROTODRILIDAE (em parte)','POEOBIIDAE','SPINTHERIDAE','5','6','11','EULEPETHIDAE','7','AFRODITIDAE','8','9','10','SIGALIONIDAE','PHOLOIDIDAE','POLYODONTIDAE','POLYNOIDAE','12','13','PALMYRIDAE','CHRYSOPETALIDAE','STERNASPIDAE','14','PISIONIDAE (em parte)','15','16','20','FLABELLIGERIDAE (parte)','17','ONUPHIDAE (parte)','18','PECTINARIIDAE','19','AMPHARETIDAE (parte)','SABELLARIIDAE','21','25','22','23','SERPULIDAE','SPIRORBIDAE (Geralmente considerada uma subfamília de SERPULIDAE)','24','OWENIIDAE (parte)','CAOBANGIIDAE','SABELLIDAE','CHAETOPTERIDAE','26','27','29','AMPHARETIDAE (parte)','28','TRICHOBRANCHIDAE','TEREBELLIDAE','30','58','31','32','EUPHROSINIDAE','AMPHINOMIDAE','33','49','TOMOPTERIDAE','34','35','36','GLYCERIDAE','GONIADIDAE','37','40','DORVILLEIDAE (parte)','38','LYSARETIDAE','39','IPHITIMIDAE','ICHTHYOTOMIDAE','PROTODRILIDAE','41','ALCIOPIDAE','42','SPHAERODORIDAE','43','PHYLLODOCIDAE','44','HISTRIOBDELLIDAE','45','LOPADORHYNCHIDAE','46','NERILLIDAE','47','ANTONBRUUNIDAE','48','NEPHTYIDAE','LACYDONIIDAE','50','52','DORVILLEIDAE (parte)','51','NEREIDAE','HESIONIDAE','ONUPHIDAE (parte)','53','54','57','PISIONIDAE (parte)','55','DORVILLEIDAE (parte)','56','PONTODORIDAE	','SYLLIDAE','PILARGIIDAE','EUNICIDAE','59','85','60','61','ACROCIRRIDAE (parte)','CIRRATULIDAE (parte)','COSSURIDAE','62','CIRRATULIDAE','63','64','68','PSAMMODRILIDAE','65','FLABELLIGERIDAE (parte)','66','FAUVELIOPSIDAE','67','CTENODRILIDAE','PARERGODRILIDAE','69','70','MALDANIDAE','SABELLONGIDAE','71','73','ORBINIIDAE','72','CAPITELLIDAE','ARENICOLIDAE','74','76','DORVILLEIDAE','75','LUMBRINERIDAE','ARABELLIDAE','PARAONIDAE (parte)','77','MALDANIDAE','78','QUESTIDAE','79','80','81','GLYCERIDAE (parte)','GONIADIDAE','TYPHLOSCOLECIDAE','82','ACROCIRRIDAE (parte)','83','BOGUEIDAE','84','OPHELIIDAE','SCALIBREGMIDAE','86','88','PARAONIDAE (parte)','87','POECILOCHAETIDAE','SPIONIDAE (parte)','89','90','IOSPILIDAE','CALAMYZIDAE','OWENIIDAE (parte)','91','MAGELONIDAE','92','HETEROSPIONIDAE','93','94','TROCHOCHAETIDAE','APISTOBRANCHIDAE','SPIONIDAE (parte)')
ref <- c(2,4,3,0,0,0,0,5,6,11,0,7,0,8,9,10,0,0,0,0,12,13,0,0,0,14,0,15,16,20,0,17,0,18,0,19,0,0,21,25,22,23,0,0,24,0,0,0,0,26,27,29,0,28,0,0,30,58,31,32,0,0,33,49,0,34,35,36,0,0,37,40,0,38,0,39,0,0,0,41,0,42,0,43,0,44,0,45,0,46,0,47,0,48,0,0,50,52,0,51,0,0,0,53,54,57,0,55,0,56,0,0,0,0,59,85,60,61,0,0,0,62,0,63,64,68,0,65,0,66,0,67,0,0,69,70,0,0,71,73,0,72,0,0,74,76,0,75,0,0,0,77,0,78,0,79,80,81,0,0,0,82,0,83,0,84,0,0,86,88,0,87,0,0,89,90,0,0,0,91,0,92,0,93,94,0,0,0)
key_poly <- data.frame(id,P,G,ref)
